$schema: https://raw.githubusercontent.com/oyvindberg/bleep/master/schema.json
$version: 0.0.1-M27
jvm:
  name: graalvm-java19:22.3.1
projects:
  scripts:
    dependencies:
    - build.bleep::bleep-core:${BLEEP_VERSION}
    - build.bleep::bleep-plugin-jni:${BLEEP_VERSION}
    - com.lihaoyi::os-lib:0.9.1
    extends: template-common
    scala:
      version: 3.2.2
  tests:
    dependencies: org.scalameta::munit:0.7.29
    dependsOn: tokenizers-scala
    extends: template-common
    isTestProject: true
  tokenizers-scala:
    dependencies: com.lihaoyi::fansi:0.3.1
    extends: template-common
    platform:
      name: jvm
      mainClass: com.foo.App
    dependsOn: native
  native:
    sourcegen:
      - main: tokenizers.scripts.GenJniLibrary
        project: scripts
      - main: tokenizers.scripts.Jextract
        project: scripts
    extends: template-common
templates:
  template-common:
    platform:
      name: jvm
      jvmOptions: ["--enable-preview", "--enable-native-access=ALL-UNNAMED", "-Djava.library.path=native/target/debug"]
    scala:
      options: -encoding utf8 -feature -unchecked
      strict: true
      version: 3.2.2
    java: 
      options: ["--enable-preview", "--release", "19"]
